(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e22a194"],{"917d":function(t,e,s){"use strict";s("b285")},9972:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"playlist"},[s("div",{staticClass:"playlist-top-card"},[s("div",{staticClass:"playlist-img-wrap"},[s("img",{attrs:{src:t.playlistInfo.img,alt:""}})]),s("div",{staticStyle:{"margin-top":"50px"}}),s("div",{staticClass:"playlist-info"},[s("div",{staticClass:"playlist-name"},[s("div",{staticClass:"tag1"},[t._v("歌单")]),t._v(t._s(t.playlistInfo.title)+" ")]),s("div",{staticClass:"playAllBtn iconfont icon-play",on:{click:t.playAll}},[t._v(" 播放全部")]),s("div",{staticClass:"playlist-tags"},[s("span",[t._v("标签：")]),s("span",{staticClass:"tags"},[t._v(t._s(t.playlistInfo.style))])]),s("div",{staticClass:"playlist-desc"},[s("span",[t._v("简介：")]),s("span",{attrs:{title:t.playlistInfo.description}},[t._v(t._s(t.playlistInfo.intro))])])])]),s("div",{staticClass:"playlist-tabs-wrap"},[s("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"歌曲列表",name:"first"}},[s("div",{staticClass:"songs-table"},[s("el-table",{directives:[{name:"el-table-infinite-scroll",rawName:"v-el-table-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{data:t.tableData,stripe:"","infinite-scroll-delay":"500","infinite-scroll-disabled":"noMore"},on:{"row-dblclick":t.play}},[s("el-table-column",{attrs:{type:"index",width:"50"}}),s("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"img-wrap"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.$store.state.baseURL+e.row.song.img,expression:"$store.state.baseURL+scope.row.song.img"}],attrs:{alt:""}}),s("p",{staticClass:"iconfont icon-play",on:{click:function(s){return t.play(e.row)}}})])]}}])}),s("el-table-column",{attrs:{prop:"song.songName",label:"歌曲",width:""}}),s("el-table-column",{attrs:{prop:"singer.singerName",label:"歌手",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"plus",staticStyle:{top:"20px"},attrs:{title:"收藏歌曲"},on:{click:function(s){return t.addToCollection(e.row,s)}}},[t._v("+")]),s("span",{staticStyle:{cursor:"pointer",color:"#2980b9"},on:{click:function(s){return t.$router.push("/artist?artistId="+e.row.singer.id)}}},[t._v(t._s(e.row.singer.singerName))])]}}])}),s("el-table-column",{attrs:{width:"",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticStyle:{top:"20px","margin-left":"-10px"},attrs:{title:"添加到歌单"}},[s("el-popover",{attrs:{placement:"right",width:"100",trigger:"click"}},[t._l(t.getData,(function(a,i){return s("p",{key:i,staticStyle:{cursor:"pointer"},on:{click:function(s){return t.addToMyList(e.row,i)}}},[t._v(t._s(a.title))])})),s("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("添加到歌单")])],2)],1)]}}])})],1)],1)]),s("el-tab-pane",{attrs:{label:"评论("+t.comments.length+")",name:"second"}},[s("div",{staticClass:"comment-wrap"},[s("h4",{staticClass:"comment-title"},[t._v("发表评论")]),s("div",{staticStyle:{padding:"0 800px 0 0"}},[s("el-input",{staticStyle:{"margin-bottom":"5px"},attrs:{type:"textarea",rows:2,placeholder:"发表你的想法"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),s("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[s("el-button",{attrs:{icon:"el-icon-edit",circle:""},on:{click:t.commit}})],1)],1),s("h4",{staticClass:"comment-title"},[t._v("所有评论")]),s("ul",t._l(t.comments,(function(e,a){return s("li",{key:a},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.$store.state.baseURL+e.client.img,expression:"$store.state.baseURL+item.client.img"}],staticClass:"comment-avatar",attrs:{alt:""}}),s("div",{staticClass:"comment-info"},[s("div",{staticClass:"comment"},[s("span",{staticClass:"comment-user"},[t._v(t._s(e.client.username))])]),s("div",{staticClass:"comment-bottom"},[s("span",{staticClass:"comment-content"},[t._v(t._s(e.content))])])])])})),0)])])],1)],1)])},i=[],n=s("b85c"),o=(s("d3b7"),s("3ca3"),s("ddb0"),s("99af"),s("521e")),l=s("7c15"),c={data:function(){return{activeName:"first",playlistInfo:{},trackIds:[],tableData:[],comments:[],hotComments:[],total:0,pageSize:10,page:1,playlistId:"",loading:!0,loadBegin:0,allData:[],showAddBall:!1,songList:[],textarea:"",getData:[]}},components:{},directives:{"el-table-infinite-scroll":o["a"]},created:function(){console.log(this.$route.query.id);var t=this.$route.query.id;this.playlistId=t,this.getTableData()},computed:{noMore:function(){return this.tableData.length>=this.trackIds.length},nowIndex:function(){return this.$store.state.nowIndex},musicQueue:function(){return this.$store.state.musicQueue},queuePos:function(){return this.$store.state.queuePos}},methods:{playAll:function(){var t=this.tableData;if(console.log("allSongs"),console.log(t),this.$store.commit("clearMusicQueue"),0!==t.length){var e,s=Object(n["a"])(t);try{for(s.s();!(e=s.n()).done;){var a=e.value,i={id:a.song.id,imgUrl:a.song.img,artistInfo:a.singer.singerName,songName:a.song.songName};this.$store.commit("changeMusicQueue",i)}}catch(o){s.e(o)}finally{s.f()}this.$store.commit("changeNowIndex",0),this.play(t[0])}else this.$message({type:"info",message:"你的歌单中还没有歌曲"})},addToMyList:function(t,e){var s=this,a={id:this.getData[e].id,singerName:t.singer.singerName,songName:t.song.songName};console.log(e),Object(l["b"])(a).then((function(){s.$message({showClose:!0,message:"添加成功",type:"success"})}))},addToCollection:function(t){var e=this;if("true"==localStorage.isLogin){var s={clientId:localStorage.uid,songId:t.song.id,type:1};Object(l["a"])(s),this.$message({showClose:!0,message:"收藏成功",type:"success"})}else this.$confirm("收藏歌曲需要登录, 是否前往登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$router.push("/login")})).catch((function(){e.$message({type:"info",message:"已取消"})}))},commit:function(){var t=this;"true"==localStorage.isLogin?""!==this.textarea?Object(l["o"])({clientId:localStorage.uid,sheetId:this.playlistId,content:this.textarea}).then((function(){t.loading=!0;var e=t.playlistId;Object(l["e"])(e).then((function(e){console.log(e),t.comments=e.data.data})).then((function(){t.$message({showClose:!0,message:"评论成功",type:"success"})})),t.loading=!1})):this.$message({type:"info",message:"请输入内容"}):this.$confirm("发表评论需要登录, 是否前往登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$router.push("/login")})).catch((function(){t.$message({type:"info",message:"已取消"})}))},toArtist:function(t){this.$router.push("/artist?artistId=".concat(t))},handleCurrentChange:function(t){this.page=t,this.getComments()},loadMore:function(){console.log("滚动加载"),this.loading=!0,this.loadBegin+=20,this.getTableData()},beginAnimation:function(t,e){var s=this;this.showAddBall=!0;var a=this.queuePos.left,i=this.queuePos.top;console.log("起始位置 x:"+t+" y:"+e),console.log("终点位置 x:"+a+" y:"+i);var n=document.querySelector(".add-ball");n.style.left=t+"px",n.style.top=e+"px",setTimeout((function(){n.style.left=a+"px",n.style.top=i+"px"}),0),setTimeout((function(){s.showAddBall=!1}),500)},getTableData:function(){var t=this;Object(l["n"])(this.playlistId).then((function(e){t.playlistInfo=e.data.data.sheet,t.playlistInfo.img=t.$store.state.baseURL+t.playlistInfo.img,t.songList=e.data.data.songList,Promise.all([t.getTracks(!1),t.getComments(!0)]).then((function(){console.log("1111")}))})).then((function(){t.loading=!1})),Object(l["w"])(localStorage.uid).then((function(e){t.getData=e.data.data.sheetList,console.log(t.getData)}))},getTracks:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[];e=this.songList,t?this.allData=this.allData.concat(e):this.tableData=this.tableData.concat(e)},play:function(t){console.log(t),this.songUrl=t.song.url;var e={imgUrl:t.song.img,artistInfo:t.singer.singerName,songName:t.song.songName,id:t.song.id};this.$store.commit("changeMusicUrl",this.songUrl),this.$store.commit("changeMusicInfo",e),this.$store.commit("changeMusicStatus",!1),this.$store.commit("changeMusicQueue",e);var s,a=[],i=Object(n["a"])(this.musicQueue);try{for(i.s();!(s=i.n()).done;){var o=s.value;a.push(o.id)}}catch(l){i.e(l)}finally{i.f()}this.$store.commit("changeNowIndex",a.indexOf(e.id))},getComments:function(){var t=this;this.loading=!0;var e=this.playlistId;Object(l["e"])(e).then((function(e){console.log(e),t.comments=e.data.data})),setTimeout((function(){t.loading=!1}),500)}}},r=c,u=(s("917d"),s("2877")),d=Object(u["a"])(r,a,i,!1,null,"7f4ff54e",null);e["default"]=d.exports},b285:function(t,e,s){}}]);